
Creating window glfw
Epochs: 0, Loss: 1942841856.0, lr: 0.004
Epochs: 1, Loss: 1768453504.0, lr: 0.004
Epochs: 2, Loss: 1621032320.0, lr: 0.004
Epochs: 3, Loss: 1476818304.0, lr: 0.004
Epochs: 4, Loss: 1332125440.0, lr: 0.004
Epochs: 5, Loss: 1191096448.0, lr: 0.004
Epochs: 6, Loss: 1057039104.0, lr: 0.004
Epochs: 7, Loss: 930114944.0, lr: 0.004
Epochs: 8, Loss: 809341056.0, lr: 0.004
Epochs: 9, Loss: 695220480.0, lr: 0.004
Epochs: 10, Loss: 590301312.0, lr: 0.004
Epochs: 11, Loss: 497728064.0, lr: 0.004
Epochs: 12, Loss: 418258176.0, lr: 0.004
Epochs: 13, Loss: 349487296.0, lr: 0.004
Epochs: 14, Loss: 290779136.0, lr: 0.004
Epochs: 15, Loss: 244002496.0, lr: 0.004
Epochs: 16, Loss: 209253136.0, lr: 0.004
Epochs: 17, Loss: 183626528.0, lr: 0.004
Epochs: 18, Loss: 163775472.0, lr: 0.004
Epochs: 19, Loss: 147963440.0, lr: 0.004
Epochs: 20, Loss: 135478160.0, lr: 0.004
Epochs: 21, Loss: 125286176.0, lr: 0.004
Epochs: 22, Loss: 116005760.0, lr: 0.004
Epochs: 23, Loss: 106880720.0, lr: 0.004
Epochs: 24, Loss: 98085424.0, lr: 0.004
Epochs: 25, Loss: 90059920.0, lr: 0.004
Epochs: 26, Loss: 82864584.0, lr: 0.004
Epochs: 27, Loss: 76212504.0, lr: 0.004
Epochs: 28, Loss: 69923256.0, lr: 0.004
Epochs: 29, Loss: 64115352.0, lr: 0.004
Epochs: 30, Loss: 58946716.0, lr: 0.004
Epochs: 31, Loss: 54360004.0, lr: 0.004
Epochs: 32, Loss: 50172288.0, lr: 0.004
Epochs: 33, Loss: 46310512.0, lr: 0.004
Epochs: 34, Loss: 42847696.0, lr: 0.004
Epochs: 35, Loss: 39844020.0, lr: 0.004
Epochs: 36, Loss: 37239080.0, lr: 0.004
Epochs: 37, Loss: 34915944.0, lr: 0.004
Epochs: 38, Loss: 32817616.0, lr: 0.004
Epochs: 39, Loss: 30960254.0, lr: 0.004
Epochs: 40, Loss: 29356052.0, lr: 0.004
Epochs: 41, Loss: 27964374.0, lr: 0.004
Epochs: 42, Loss: 26721910.0, lr: 0.004
Epochs: 43, Loss: 25593606.0, lr: 0.004
Epochs: 44, Loss: 24580932.0, lr: 0.004
Epochs: 45, Loss: 23690414.0, lr: 0.004
Epochs: 46, Loss: 22907962.0, lr: 0.004
Epochs: 47, Loss: 22205002.0, lr: 0.004
Epochs: 48, Loss: 21561380.0, lr: 0.004
Epochs: 49, Loss: 20975238.0, lr: 0.004
Epochs: 50, Loss: 20452128.0, lr: 0.004
Epochs: 51, Loss: 19989882.0, lr: 0.004
Epochs: 52, Loss: 19576094.0, lr: 0.004
Epochs: 53, Loss: 19197418.0, lr: 0.004
Epochs: 54, Loss: 18848358.0, lr: 0.004
Epochs: 55, Loss: 18530814.0, lr: 0.004
Epochs: 56, Loss: 18246992.0, lr: 0.004
Epochs: 57, Loss: 17994316.0, lr: 0.004
Epochs: 58, Loss: 17766522.0, lr: 0.004
Epochs: 59, Loss: 17558646.0, lr: 0.004
Epochs: 60, Loss: 17369638.0, lr: 0.004
Epochs: 61, Loss: 17200444.0, lr: 0.004
Epochs: 62, Loss: 17050400.0, lr: 0.004
Epochs: 63, Loss: 16916016.0, lr: 0.004
Epochs: 64, Loss: 16793050.0, lr: 0.004
Epochs: 65, Loss: 16679288.0, lr: 0.004
Epochs: 66, Loss: 16575108.0, lr: 0.004
Epochs: 67, Loss: 16481654.0, lr: 0.004
Epochs: 68, Loss: 16398822.0, lr: 0.004
Epochs: 69, Loss: 16324993.0, lr: 0.004
Epochs: 70, Loss: 16258423.0, lr: 0.004
Epochs: 71, Loss: 16198402.0, lr: 0.004
Epochs: 72, Loss: 16144954.0, lr: 0.004
Epochs: 73, Loss: 16097697.0, lr: 0.004
Epochs: 74, Loss: 16055304.0, lr: 0.004
Epochs: 75, Loss: 16016171.0, lr: 0.004
Epochs: 76, Loss: 15979493.0, lr: 0.004
Epochs: 77, Loss: 15945534.0, lr: 0.004
Epochs: 78, Loss: 15914871.0, lr: 0.004
Epochs: 79, Loss: 15887537.0, lr: 0.004
Epochs: 80, Loss: 15862994.0, lr: 0.004
Epochs: 81, Loss: 15840663.0, lr: 0.004
Epochs: 82, Loss: 15820347.0, lr: 0.004
Epochs: 83, Loss: 15802002.0, lr: 0.004
Epochs: 84, Loss: 15785307.0, lr: 0.004
Epochs: 85, Loss: 15769638.0, lr: 0.004
Epochs: 86, Loss: 15754500.0, lr: 0.004
Epochs: 87, Loss: 15739857.0, lr: 0.004
Epochs: 88, Loss: 15726014.0, lr: 0.004
Epochs: 89, Loss: 15713210.0, lr: 0.004
Epochs: 90, Loss: 15701359.0, lr: 0.004
Epochs: 91, Loss: 15690251.0, lr: 0.004
Epochs: 92, Loss: 15679794.0, lr: 0.004
Epochs: 93, Loss: 15669965.0, lr: 0.004
Epochs: 94, Loss: 15660682.0, lr: 0.004
Epochs: 95, Loss: 15651714.0, lr: 0.004
Epochs: 96, Loss: 15642859.0, lr: 0.004
Epochs: 97, Loss: 15634145.0, lr: 0.004
Epochs: 98, Loss: 15625728.0, lr: 0.004
Epochs: 99, Loss: 15617742.0, lr: 0.004
Epochs: 100, Loss: 15610172.0, lr: 0.004
Epochs: 101, Loss: 15602958.0, lr: 0.004
Epochs: 102, Loss: 15596070.0, lr: 0.004
Epochs: 103, Loss: 15589519.0, lr: 0.004
Epochs: 104, Loss: 15583248.0, lr: 0.004
Epochs: 105, Loss: 15577170.0, lr: 0.004
Epochs: 106, Loss: 15571241.0, lr: 0.004
Epochs: 107, Loss: 15565495.0, lr: 0.004
Epochs: 108, Loss: 15560012.0, lr: 0.004
Epochs: 109, Loss: 15554831.0, lr: 0.004
Epochs: 110, Loss: 15549924.0, lr: 0.004
Epochs: 111, Loss: 15545266.0, lr: 0.004
Epochs: 112, Loss: 15540853.0, lr: 0.004
Epochs: 113, Loss: 15536677.0, lr: 0.004
Epochs: 114, Loss: 15532694.0, lr: 0.004
Epochs: 115, Loss: 15528873.0, lr: 0.004
Epochs: 116, Loss: 15525200.0, lr: 0.004
Epochs: 117, Loss: 15521706.0, lr: 0.004
Epochs: 118, Loss: 15518393.0, lr: 0.004
Epochs: 119, Loss: 15515260.0, lr: 0.004
Epochs: 120, Loss: 15512288.0, lr: 0.004
Epochs: 121, Loss: 15509457.0, lr: 0.004
Epochs: 122, Loss: 15506760.0, lr: 0.004
Epochs: 123, Loss: 15504176.0, lr: 0.004
Epochs: 124, Loss: 15501683.0, lr: 0.004
Epochs: 125, Loss: 15499269.0, lr: 0.004
Epochs: 126, Loss: 15496934.0, lr: 0.004
Epochs: 127, Loss: 15494684.0, lr: 0.004
Epochs: 128, Loss: 15492506.0, lr: 0.004
Epochs: 129, Loss: 15490394.0, lr: 0.004
Epochs: 130, Loss: 15488338.0, lr: 0.004
Epochs: 131, Loss: 15486326.0, lr: 0.004
Epochs: 132, Loss: 15484355.0, lr: 0.004
Epochs: 133, Loss: 15482406.0, lr: 0.004
Epochs: 134, Loss: 15480479.0, lr: 0.004
Epochs: 135, Loss: 15478579.0, lr: 0.004
Epochs: 136, Loss: 15476697.0, lr: 0.004
Epochs: 137, Loss: 15474834.0, lr: 0.004
Epochs: 138, Loss: 15472986.0, lr: 0.004
Epochs: 139, Loss: 15471154.0, lr: 0.004
Epochs: 140, Loss: 15469334.0, lr: 0.004
Epochs: 141, Loss: 15467524.0, lr: 0.004
Epochs: 142, Loss: 15465715.0, lr: 0.004
Epochs: 143, Loss: 15463910.0, lr: 0.004
Epochs: 144, Loss: 15462110.0, lr: 0.004
Epochs: 145, Loss: 15460316.0, lr: 0.004
Epochs: 146, Loss: 15458534.0, lr: 0.004
Epochs: 147, Loss: 15456758.0, lr: 0.004
Epochs: 148, Loss: 15454993.0, lr: 0.004
Epochs: 149, Loss: 15453234.0, lr: 0.004
Epochs: 150, Loss: 15451483.0, lr: 0.004
Epochs: 151, Loss: 15449739.0, lr: 0.004
Epochs: 152, Loss: 15448001.0, lr: 0.004
Epochs: 153, Loss: 15446274.0, lr: 0.004
Epochs: 154, Loss: 15444558.0, lr: 0.004
Epochs: 155, Loss: 15442856.0, lr: 0.004
Epochs: 156, Loss: 15441164.0, lr: 0.004
Epochs: 157, Loss: 15439489.0, lr: 0.004
Epochs: 158, Loss: 15437828.0, lr: 0.004
Epochs: 159, Loss: 15436178.0, lr: 0.004
Epochs: 160, Loss: 15434535.0, lr: 0.004
Epochs: 161, Loss: 15432910.0, lr: 0.004
Epochs: 162, Loss: 15431296.0, lr: 0.004
Epochs: 163, Loss: 15429701.0, lr: 0.004
Epochs: 164, Loss: 15428119.0, lr: 0.004
Epochs: 165, Loss: 15426556.0, lr: 0.004
Epochs: 166, Loss: 15425006.0, lr: 0.004
Epochs: 167, Loss: 15423468.0, lr: 0.004
Epochs: 168, Loss: 15421947.0, lr: 0.004
Epochs: 169, Loss: 15420436.0, lr: 0.004
Epochs: 170, Loss: 15418939.0, lr: 0.004
Epochs: 171, Loss: 15417461.0, lr: 0.004
Epochs: 172, Loss: 15415993.0, lr: 0.004
Epochs: 173, Loss: 15414541.0, lr: 0.004
Epochs: 174, Loss: 15413097.0, lr: 0.004
Epochs: 175, Loss: 15411675.0, lr: 0.004
Epochs: 176, Loss: 15410255.0, lr: 0.004
Epochs: 177, Loss: 15408854.0, lr: 0.004
Epochs: 178, Loss: 15407463.0, lr: 0.004
Epochs: 179, Loss: 15406083.0, lr: 0.004
Epochs: 180, Loss: 15404710.0, lr: 0.004
Epochs: 181, Loss: 15403351.0, lr: 0.004
Epochs: 182, Loss: 15402005.0, lr: 0.004
Epochs: 183, Loss: 15400666.0, lr: 0.004
Epochs: 184, Loss: 15399335.0, lr: 0.004
Epochs: 185, Loss: 15398014.0, lr: 0.004
Epochs: 186, Loss: 15396699.0, lr: 0.004
Epochs: 187, Loss: 15395392.0, lr: 0.004
Epochs: 188, Loss: 15394098.0, lr: 0.004
Epochs: 189, Loss: 15392809.0, lr: 0.004
Epochs: 190, Loss: 15391529.0, lr: 0.004
Epochs: 191, Loss: 15390252.0, lr: 0.004
Epochs: 192, Loss: 15388984.0, lr: 0.004
Epochs: 193, Loss: 15387722.0, lr: 0.004
Epochs: 194, Loss: 15386464.0, lr: 0.004
Epochs: 195, Loss: 15385218.0, lr: 0.004
Epochs: 196, Loss: 15383966.0, lr: 0.004
Epochs: 197, Loss: 15382730.0, lr: 0.004
Epochs: 198, Loss: 15381497.0, lr: 0.004
Epochs: 199, Loss: 15380264.0, lr: 0.004
Epochs: 200, Loss: 15379041.0, lr: 0.004
Epochs: 201, Loss: 15377819.0, lr: 0.004
Epochs: 202, Loss: 15376600.0, lr: 0.004
Epochs: 203, Loss: 15375385.0, lr: 0.004
Epochs: 204, Loss: 15374179.0, lr: 0.004
Epochs: 205, Loss: 15372973.0, lr: 0.004
Epochs: 206, Loss: 15371776.0, lr: 0.004
Epochs: 207, Loss: 15370578.0, lr: 0.004
Epochs: 208, Loss: 15369385.0, lr: 0.004
Epochs: 209, Loss: 15368194.0, lr: 0.004
Epochs: 210, Loss: 15367007.0, lr: 0.004
Epochs: 211, Loss: 15365826.0, lr: 0.004
Epochs: 212, Loss: 15364645.0, lr: 0.004
Epochs: 213, Loss: 15363471.0, lr: 0.004
Epochs: 214, Loss: 15362299.0, lr: 0.004
Epochs: 215, Loss: 15361128.0, lr: 0.004
Epochs: 216, Loss: 15359966.0, lr: 0.004
Epochs: 217, Loss: 15358802.0, lr: 0.004
Epochs: 218, Loss: 15357641.0, lr: 0.004
Epochs: 219, Loss: 15356484.0, lr: 0.004
Epochs: 220, Loss: 15355330.0, lr: 0.004
Epochs: 221, Loss: 15354180.0, lr: 0.004
Epochs: 222, Loss: 15353033.0, lr: 0.004
Epochs: 223, Loss: 15351891.0, lr: 0.004
Epochs: 224, Loss: 15350748.0, lr: 0.004
Epochs: 225, Loss: 15349613.0, lr: 0.004
Epochs: 226, Loss: 15348476.0, lr: 0.004
Epochs: 227, Loss: 15347348.0, lr: 0.004
Epochs: 228, Loss: 15346221.0, lr: 0.004
Epochs: 229, Loss: 15345094.0, lr: 0.004
Epochs: 230, Loss: 15343974.0, lr: 0.004
Epochs: 231, Loss: 15342855.0, lr: 0.004
########## Saving Trace ##########
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 177, in <module>
    traj, dtraj_dt = odeint(dyn_system, x_init, time, method='euler', options=dict(step_size=dt))
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 209, in odeint_adjoint
    adjoint_method, adjoint_options, t.requires_grad, *adjoint_params)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 23, in forward
    ans, ans_dt = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/odeint.py", line 57, in odeint
    solution, solution_dt = solver.integrate(t)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/solvers.py", line 72, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/fixed_grid.py", line 9, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1208, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 166, in forward
    xd = self._step_func(x, u)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 65, in simulate_PFL
    return self.PFL(x, acc)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 194, in PFL
    Tp = (self._Tgrav(q) - (self._Cfull(x) @ qd.mT).mT)[:, :, 1].clone()
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 167, in _Cfull
    qp, qdp = x[:, :, 1].unsqueeze(1).clone(), x[:, :, 3].unsqueeze(1).clone()
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 218, in <module>
    model_scripted = torch.jit.script(dyn_system.value_func.to('cpu'))  # Export to TorchScript
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_script.py", line 1287, in script
    obj, torch.jit._recursive.infer_methods_to_compile
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 476, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 393, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError:
attribute lookup is not defined on python value of type 'SimulationParams':
  File "tv_value_synthesis_trajopt_cartpole.py", line 64
    def forward(self, t, x):
        time = torch.ones((sim_params.nsim, 1, 1)).to(device) * t
                           ~~~~~~~~~~~~~~~ <--- HERE
        aug_x = torch.cat((x, time), dim=2)
        return self.nn(aug_x)