
Creating window glfw
Epochs: 0, Loss: 3359874560.0, lr: 0.004
Epochs: 1, Loss: 3293371136.0, lr: 0.004
Epochs: 2, Loss: 3211942912.0, lr: 0.004
Epochs: 3, Loss: 3146773760.0, lr: 0.004
Epochs: 4, Loss: 3095964928.0, lr: 0.004
Epochs: 5, Loss: 3044468736.0, lr: 0.004
Epochs: 6, Loss: 2994726400.0, lr: 0.004
Epochs: 7, Loss: 2951879424.0, lr: 0.004
Epochs: 8, Loss: 2914778368.0, lr: 0.004
Epochs: 9, Loss: 2879671296.0, lr: 0.004
Epochs: 10, Loss: 2845637376.0, lr: 0.004
Epochs: 11, Loss: 2814202368.0, lr: 0.004
Epochs: 12, Loss: 2786275072.0, lr: 0.004
Epochs: 13, Loss: 2760947968.0, lr: 0.004
Epochs: 14, Loss: 2736778496.0, lr: 0.004
Epochs: 15, Loss: 2713382656.0, lr: 0.004
Epochs: 16, Loss: 2691348736.0, lr: 0.004
Epochs: 17, Loss: 2671063040.0, lr: 0.004
Epochs: 18, Loss: 2652097536.0, lr: 0.004
Epochs: 19, Loss: 2633710848.0, lr: 0.004
Epochs: 20, Loss: 2615587328.0, lr: 0.004
Epochs: 21, Loss: 2597825280.0, lr: 0.004
Epochs: 22, Loss: 2580361472.0, lr: 0.004
Epochs: 23, Loss: 2562679552.0, lr: 0.004
Epochs: 24, Loss: 2544156160.0, lr: 0.004
Epochs: 25, Loss: 2524487424.0, lr: 0.004
Epochs: 26, Loss: 2503570176.0, lr: 0.004
Epochs: 27, Loss: 2481112832.0, lr: 0.004
Epochs: 28, Loss: 2456562944.0, lr: 0.004
Epochs: 29, Loss: 2429430016.0, lr: 0.004
Epochs: 30, Loss: 2399482880.0, lr: 0.004
Epochs: 31, Loss: 2366612480.0, lr: 0.004
Epochs: 32, Loss: 2330694400.0, lr: 0.004
Epochs: 33, Loss: 2291759104.0, lr: 0.004
Epochs: 34, Loss: 2250285312.0, lr: 0.004
Epochs: 35, Loss: 2207285504.0, lr: 0.004
Epochs: 36, Loss: 2164176128.0, lr: 0.004
Epochs: 37, Loss: 2122557952.0, lr: 0.004
Epochs: 38, Loss: 2083917696.0, lr: 0.004
Epochs: 39, Loss: 2049327104.0, lr: 0.004
Epochs: 40, Loss: 2019294464.0, lr: 0.004
Epochs: 41, Loss: 1993897216.0, lr: 0.004
Epochs: 42, Loss: 1972929408.0, lr: 0.004
Epochs: 43, Loss: 1956115456.0, lr: 0.004
Epochs: 44, Loss: 1943018880.0, lr: 0.004
Epochs: 45, Loss: 1932794368.0, lr: 0.004
Epochs: 46, Loss: 1924410624.0, lr: 0.004
Epochs: 47, Loss: 1917073152.0, lr: 0.004
Epochs: 48, Loss: 1910241024.0, lr: 0.004
Epochs: 49, Loss: 1903465728.0, lr: 0.004
Epochs: 50, Loss: 1896403968.0, lr: 0.004
Epochs: 51, Loss: 1888900352.0, lr: 0.004
Epochs: 52, Loss: 1880988032.0, lr: 0.004
Epochs: 53, Loss: 1872822656.0, lr: 0.004
Epochs: 54, Loss: 1864617344.0, lr: 0.004
Epochs: 55, Loss: 1856611712.0, lr: 0.004
Epochs: 56, Loss: 1849045504.0, lr: 0.004
Epochs: 57, Loss: 1842111872.0, lr: 0.004
Epochs: 58, Loss: 1835910144.0, lr: 0.004
Epochs: 59, Loss: 1830400000.0, lr: 0.004
Epochs: 60, Loss: 1825354368.0, lr: 0.004
Epochs: 61, Loss: 1820484864.0, lr: 0.004
Epochs: 62, Loss: 1815869952.0, lr: 0.004
Epochs: 63, Loss: 1811729280.0, lr: 0.004
Epochs: 64, Loss: 1808155520.0, lr: 0.004
Epochs: 65, Loss: 1805149056.0, lr: 0.004
Epochs: 66, Loss: 1802704768.0, lr: 0.004
Epochs: 67, Loss: 1800845824.0, lr: 0.004
Epochs: 68, Loss: 1799638912.0, lr: 0.004
Epochs: 69, Loss: 1799129216.0, lr: 0.004
Epochs: 70, Loss: 1799325952.0, lr: 0.004
Epochs: 71, Loss: 1800249600.0, lr: 0.004
Epochs: 72, Loss: 1802031104.0, lr: 0.004
Epochs: 73, Loss: 1804947456.0, lr: 0.004
Epochs: 74, Loss: 1809119616.0, lr: 0.004
Epochs: 75, Loss: 1814295936.0, lr: 0.004
Epochs: 76, Loss: 1819939840.0, lr: 0.004
Epochs: 77, Loss: 1825517824.0, lr: 0.004
Epochs: 78, Loss: 1831489664.0, lr: 0.004
Epochs: 79, Loss: 1837694976.0, lr: 0.004
Epochs: 80, Loss: 1841699712.0, lr: 0.004
Epochs: 81, Loss: 1845384448.0, lr: 0.004
Epochs: 82, Loss: 1843872128.0, lr: 0.004
Epochs: 83, Loss: 1842325760.0, lr: 0.004
Epochs: 84, Loss: 1850550272.0, lr: 0.004
Epochs: 85, Loss: 1852593152.0, lr: 0.004
Epochs: 86, Loss: 1848332928.0, lr: 0.004
Epochs: 87, Loss: 1841140864.0, lr: 0.004
Epochs: 88, Loss: 1831010944.0, lr: 0.004
Epochs: 89, Loss: 1814904448.0, lr: 0.004
Epochs: 90, Loss: 1792985856.0, lr: 0.004
Epochs: 91, Loss: 1771504128.0, lr: 0.004
Epochs: 92, Loss: 1753788160.0, lr: 0.004
Epochs: 93, Loss: 1740874240.0, lr: 0.004
Epochs: 94, Loss: 1731798656.0, lr: 0.004
Epochs: 95, Loss: 1722651520.0, lr: 0.004
Epochs: 96, Loss: 1713570048.0, lr: 0.004
Epochs: 97, Loss: 1704766080.0, lr: 0.004
Epochs: 98, Loss: 1698052096.0, lr: 0.004
Epochs: 99, Loss: 1692814080.0, lr: 0.004
Epochs: 100, Loss: 1691413760.0, lr: 0.004
Epochs: 101, Loss: 1693568768.0, lr: 0.004
Epochs: 102, Loss: 1696543360.0, lr: 0.004
Epochs: 103, Loss: 1696978688.0, lr: 0.004
Epochs: 104, Loss: 1692498816.0, lr: 0.004
Epochs: 105, Loss: 1683482240.0, lr: 0.004
Epochs: 106, Loss: 1671686016.0, lr: 0.004
Epochs: 107, Loss: 1660934144.0, lr: 0.004
Epochs: 108, Loss: 1654734976.0, lr: 0.004
Epochs: 109, Loss: 1650784384.0, lr: 0.004
Epochs: 110, Loss: 1648258560.0, lr: 0.004
Epochs: 111, Loss: 1648561152.0, lr: 0.004
Epochs: 112, Loss: 1652675328.0, lr: 0.004
Epochs: 113, Loss: 1657148288.0, lr: 0.004
Epochs: 114, Loss: 1658454656.0, lr: 0.004
Epochs: 115, Loss: 1655384576.0, lr: 0.004
Epochs: 116, Loss: 1648346496.0, lr: 0.004
Epochs: 117, Loss: 1638404096.0, lr: 0.004
Epochs: 118, Loss: 1628310144.0, lr: 0.004
Epochs: 119, Loss: 1620459520.0, lr: 0.004
Epochs: 120, Loss: 1615132416.0, lr: 0.004
Epochs: 121, Loss: 1613252480.0, lr: 0.004
Epochs: 122, Loss: 1616131328.0, lr: 0.004
Epochs: 123, Loss: 1622967296.0, lr: 0.004
Epochs: 124, Loss: 1631073792.0, lr: 0.004
Epochs: 125, Loss: 1639225856.0, lr: 0.004
Epochs: 126, Loss: 1646625408.0, lr: 0.004
Epochs: 127, Loss: 1652294016.0, lr: 0.004
Epochs: 128, Loss: 1655027328.0, lr: 0.004
Epochs: 129, Loss: 1653510144.0, lr: 0.004
Epochs: 130, Loss: 1647647872.0, lr: 0.004
Epochs: 131, Loss: 1639481344.0, lr: 0.004
Epochs: 132, Loss: 1631728768.0, lr: 0.004
Epochs: 133, Loss: 1625859072.0, lr: 0.004
Epochs: 134, Loss: 1622246656.0, lr: 0.004
Epochs: 135, Loss: 1620520320.0, lr: 0.004
Epochs: 136, Loss: 1619901952.0, lr: 0.004
Epochs: 137, Loss: 1620291456.0, lr: 0.004
Epochs: 138, Loss: 1621782912.0, lr: 0.004
Epochs: 139, Loss: 1623649280.0, lr: 0.004
Epochs: 140, Loss: 1624292608.0, lr: 0.004
Epochs: 141, Loss: 1622802944.0, lr: 0.004
Epochs: 142, Loss: 1619071104.0, lr: 0.004
Epochs: 143, Loss: 1613428992.0, lr: 0.004
Epochs: 144, Loss: 1606494848.0, lr: 0.004
Epochs: 145, Loss: 1599248896.0, lr: 0.004
Epochs: 146, Loss: 1592947584.0, lr: 0.004
Epochs: 147, Loss: 1588452736.0, lr: 0.004
Epochs: 148, Loss: 1585911680.0, lr: 0.004
Epochs: 149, Loss: 1585324032.0, lr: 0.004
Epochs: 150, Loss: 1586561408.0, lr: 0.004
Epochs: 151, Loss: 1589235200.0, lr: 0.004
Epochs: 152, Loss: 1592379904.0, lr: 0.004
Epochs: 153, Loss: 1593912448.0, lr: 0.004
Epochs: 154, Loss: 1593856384.0, lr: 0.004
Epochs: 155, Loss: 1592966784.0, lr: 0.004
Epochs: 156, Loss: 1590833536.0, lr: 0.004
Epochs: 157, Loss: 1587276928.0, lr: 0.004
Epochs: 158, Loss: 1583457920.0, lr: 0.004
Epochs: 159, Loss: 1580072448.0, lr: 0.004
Epochs: 160, Loss: 1577520640.0, lr: 0.004
Epochs: 161, Loss: 1575692032.0, lr: 0.004
Epochs: 162, Loss: 1573953280.0, lr: 0.004
Epochs: 163, Loss: 1572948224.0, lr: 0.004
Epochs: 164, Loss: 1572265600.0, lr: 0.004
Epochs: 165, Loss: 1572364928.0, lr: 0.004
Epochs: 166, Loss: 1574357248.0, lr: 0.004
Epochs: 167, Loss: 1576603136.0, lr: 0.004
Epochs: 168, Loss: 1578198016.0, lr: 0.004
Epochs: 169, Loss: 1580554880.0, lr: 0.004
Epochs: 170, Loss: 1583140864.0, lr: 0.004
Epochs: 171, Loss: 1585104256.0, lr: 0.004
Epochs: 172, Loss: 1585987584.0, lr: 0.004
Epochs: 173, Loss: 1585924096.0, lr: 0.004
Epochs: 174, Loss: 1585288576.0, lr: 0.004
Epochs: 175, Loss: 1584405632.0, lr: 0.004
Epochs: 176, Loss: 1583521920.0, lr: 0.004
Epochs: 177, Loss: 1582786560.0, lr: 0.004
Epochs: 178, Loss: 1582144256.0, lr: 0.004
Epochs: 179, Loss: 1581406336.0, lr: 0.004
Epochs: 180, Loss: 1580553600.0, lr: 0.004
Epochs: 181, Loss: 1579902592.0, lr: 0.004
Epochs: 182, Loss: 1579811200.0, lr: 0.004
Epochs: 183, Loss: 1580550656.0, lr: 0.004
Epochs: 184, Loss: 1582192640.0, lr: 0.004
Epochs: 185, Loss: 1584312832.0, lr: 0.004
Epochs: 186, Loss: 1585727360.0, lr: 0.004
Epochs: 187, Loss: 1585506304.0, lr: 0.004
Epochs: 188, Loss: 1583739520.0, lr: 0.004
Epochs: 189, Loss: 1581153152.0, lr: 0.004
Epochs: 190, Loss: 1578597120.0, lr: 0.004
Epochs: 191, Loss: 1576723712.0, lr: 0.004
Epochs: 192, Loss: 1575544320.0, lr: 0.004
Epochs: 193, Loss: 1574378240.0, lr: 0.004
Epochs: 194, Loss: 1572718336.0, lr: 0.004
Epochs: 195, Loss: 1570857984.0, lr: 0.004
Epochs: 196, Loss: 1569258368.0, lr: 0.004
Epochs: 197, Loss: 1567887104.0, lr: 0.004
Epochs: 198, Loss: 1566499456.0, lr: 0.004
Epochs: 199, Loss: 1565085184.0, lr: 0.004
Epochs: 200, Loss: 1564018304.0, lr: 0.004
Epochs: 201, Loss: 1563821568.0, lr: 0.004
Epochs: 202, Loss: 1565064448.0, lr: 0.004
Epochs: 203, Loss: 1568466816.0, lr: 0.004
Epochs: 204, Loss: 1575384064.0, lr: 0.004
Epochs: 205, Loss: 1586723840.0, lr: 0.004
Epochs: 206, Loss: 1596402432.0, lr: 0.004
Epochs: 207, Loss: 1600468352.0, lr: 0.004
Epochs: 208, Loss: 1597347712.0, lr: 0.004
Epochs: 209, Loss: 1589575808.0, lr: 0.004
Epochs: 210, Loss: 1584649856.0, lr: 0.004
Epochs: 211, Loss: 1585563264.0, lr: 0.004
Epochs: 212, Loss: 1587215104.0, lr: 0.004
Epochs: 213, Loss: 1586162048.0, lr: 0.004
Epochs: 214, Loss: 1588019584.0, lr: 0.004
Epochs: 215, Loss: 1592822272.0, lr: 0.004
Epochs: 216, Loss: 1594714624.0, lr: 0.004
Epochs: 217, Loss: 1593224704.0, lr: 0.004
Epochs: 218, Loss: 1596917120.0, lr: 0.004
Epochs: 219, Loss: 1628788096.0, lr: 0.004
Epochs: 220, Loss: 1654495104.0, lr: 0.004
Epochs: 221, Loss: 1670258176.0, lr: 0.004
Epochs: 222, Loss: 1695481216.0, lr: 0.004
Epochs: 223, Loss: 1683325568.0, lr: 0.004
Epochs: 224, Loss: 1652769408.0, lr: 0.004
Epochs: 225, Loss: 1631214848.0, lr: 0.004
Epochs: 226, Loss: 1636670976.0, lr: 0.004
Epochs: 227, Loss: 1644745216.0, lr: 0.004
Epochs: 228, Loss: 1638324352.0, lr: 0.004
Epochs: 229, Loss: 1637903360.0, lr: 0.004
Epochs: 230, Loss: 1650897536.0, lr: 0.004
Epochs: 231, Loss: 1670641536.0, lr: 0.004
Epochs: 232, Loss: 1685916544.0, lr: 0.004
Epochs: 233, Loss: 1670619648.0, lr: 0.004
Epochs: 234, Loss: 1634953856.0, lr: 0.004
Epochs: 235, Loss: 1605566080.0, lr: 0.004
Epochs: 236, Loss: 1587465856.0, lr: 0.004
Epochs: 237, Loss: 1597880064.0, lr: 0.004
Epochs: 238, Loss: 1601795072.0, lr: 0.004
Epochs: 239, Loss: 1592842496.0, lr: 0.004
########## Saving Trace ##########
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 168, in <module>
    traj, dtraj_dt = odeint(dyn_system, x_init, time, method='euler', options=dict(step_size=dt))
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 210, in odeint_adjoint
    adjoint_method, adjoint_options, t.requires_grad, *adjoint_params)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 23, in forward
    ans, ans_dt = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/odeint.py", line 57, in odeint
    solution, solution_dt = solver.integrate(t)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/solvers.py", line 72, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/fixed_grid.py", line 9, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1208, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 165, in forward
    u = self._ctrl(t, x)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 123, in hjb
    return self._policy(q, v, x, Vx)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 73, in underactuated_inv_policy
    ones = torch.ones((v.shape[0], 1, 1)).to(device)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 210, in <module>
    model_scripted = torch.jit.script(dyn_system.value_func.to('cpu'))  # Export to TorchScript
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_script.py", line 1287, in script
    obj, torch.jit._recursive.infer_methods_to_compile
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 476, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 393, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError:
attribute lookup is not defined on python value of type 'SimulationParams':
  File "tv_value_synthesis_trajopt_cartpole.py", line 64
    def forward(self, t, x):
        time = torch.ones((sim_params.nsim, 1, 1)).to(device) * t
                           ~~~~~~~~~~~~~~~ <--- HERE
        aug_x = torch.cat((x, time), dim=2)
        return self.nn(aug_x)