Creating window glfw
Epochs: 1, Loss: 12409624576.0, lr: 0.009940030040090253, time: 50
Epochs: 2, Loss: 12170285056.0, lr: 0.009880120321448116, time: 50
Epochs: 3, Loss: 11612186624.0, lr: 0.009820271087351824, time: 50
Epochs: 4, Loss: 11086863360.0, lr: 0.009760482583301363, time: 50
Epochs: 5, Loss: 10430342144.0, lr: 0.009700755057050188, time: 53
Epochs: 6, Loss: 9939127296.0, lr: 0.009641088758637567, time: 53
Epochs: 7, Loss: 9459758080.0, lr: 0.00958148394042156, time: 53
Epochs: 8, Loss: 9010106368.0, lr: 0.009521940857112636, time: 53
Epochs: 9, Loss: 8521721344.0, lr: 0.009462459765807965, time: 53
Epochs: 10, Loss: 7897326080.0, lr: 0.00940304092602639, time: 55
Epochs: 11, Loss: 7361937920.0, lr: 0.009343684599744093, time: 55
Epochs: 12, Loss: 6826674688.0, lr: 0.009284391051430982, time: 55
Epochs: 13, Loss: 6311146496.0, lr: 0.00922516054808782, time: 55
Epochs: 14, Loss: 5766460928.0, lr: 0.009165993359284084, time: 55
Epochs: 15, Loss: 5148873216.0, lr: 0.009106889757196639, time: 57
Epochs: 16, Loss: 4723726848.0, lr: 0.009047850016649154, time: 57
Epochs: 17, Loss: 4362283008.0, lr: 0.008988874415152377, time: 57
Epochs: 18, Loss: 4010288384.0, lr: 0.008929963232945216, time: 57
Epochs: 19, Loss: 3613041920.0, lr: 0.008871116753036697, time: 57
Epochs: 20, Loss: 3370628864.0, lr: 0.008812335261248791, time: 59
Epochs: 21, Loss: 3033963008.0, lr: 0.008753619046260144, time: 59
Epochs: 22, Loss: 2806246656.0, lr: 0.00869496839965074, time: 59
Epochs: 23, Loss: 2619006464.0, lr: 0.008636383615947521, time: 59
Epochs: 24, Loss: 2462332928.0, lr: 0.00857786499267097, time: 59
Epochs: 25, Loss: 2300655360.0, lr: 0.008519412830382721, time: 61
Epochs: 26, Loss: 2201538560.0, lr: 0.008461027432734181, time: 61
Epochs: 27, Loss: 2116988928.0, lr: 0.008402709106516233, time: 61
Epochs: 28, Loss: 2045352192.0, lr: 0.008344458161710002, time: 61
Epochs: 29, Loss: 1983835264.0, lr: 0.008286274911538785, time: 61
Epochs: 30, Loss: 1943662336.0, lr: 0.008228159672521091, time: 63
Epochs: 31, Loss: 1901887360.0, lr: 0.008170112764524893, time: 63
Epochs: 32, Loss: 1866740864.0, lr: 0.008112134510823083, time: 63
Epochs: 33, Loss: 1838524800.0, lr: 0.008054225238150201, time: 63
Epochs: 34, Loss: 1816409216.0, lr: 0.007996385276760424, time: 63
Epochs: 35, Loss: 1818000000.0, lr: 0.007938614960486916, time: 64
Epochs: 36, Loss: 1807479424.0, lr: 0.00788091462680252, time: 64
Epochs: 37, Loss: 1801890432.0, lr: 0.007823284616881854, time: 64
Epochs: 38, Loss: 1796155008.0, lr: 0.007765725275664881, time: 64
Epochs: 39, Loss: 1792216320.0, lr: 0.007708236951921931, time: 64
Epochs: 40, Loss: 1814600960.0, lr: 0.007650819998320297, time: 65
Epochs: 41, Loss: 1810868224.0, lr: 0.007593474771492367, time: 65
Epochs: 42, Loss: 1805832576.0, lr: 0.007536201632105431, time: 65
Epochs: 43, Loss: 1798993536.0, lr: 0.007479000944933124, time: 65
Epochs: 44, Loss: 1790096128.0, lr: 0.007421873078928632, time: 65
Epochs: 45, Loss: 1811870336.0, lr: 0.007364818407299646, time: 66
Epochs: 46, Loss: 1799352064.0, lr: 0.007307837307585186, time: 66
Epochs: 47, Loss: 1785449344.0, lr: 0.007250930161734293, time: 66
Epochs: 48, Loss: 1770646400.0, lr: 0.00719409735618669, time: 66
Epochs: 49, Loss: 1755369728.0, lr: 0.007137339281955456, time: 66
Epochs: 50, Loss: 1781529344.0, lr: 0.007080656334711765, time: 67
Epochs: 51, Loss: 1766651008.0, lr: 0.007024048914871794, time: 67
Epochs: 52, Loss: 1752430848.0, lr: 0.006967517427685831, time: 67
Epochs: 53, Loss: 1739102720.0, lr: 0.006911062283329664, time: 67
Epochs: 54, Loss: 1726772096.0, lr: 0.006854683896998351, time: 67
Epochs: 55, Loss: 1760358272.0, lr: 0.006798382689002409, time: 68
Epochs: 56, Loss: 1749870976.0, lr: 0.006742159084866536, time: 68
Epochs: 57, Loss: 1733943808.0, lr: 0.006686013515430926, time: 68
Epochs: 58, Loss: 1724728832.0, lr: 0.006629946416955278, time: 68
Epochs: 59, Loss: 1715971456.0, lr: 0.006573958231225602, time: 68
Epochs: 60, Loss: 1755164416.0, lr: 0.006518049405663864, time: 69
Epochs: 61, Loss: 1745999360.0, lr: 0.006462220393440652, time: 69
Epochs: 62, Loss: 1736679936.0, lr: 0.006406471653590877, time: 69
Epochs: 63, Loss: 1727167360.0, lr: 0.006350803651132698, time: 69
Epochs: 64, Loss: 1717588864.0, lr: 0.0062952168571896935, time: 69
Epochs: 65, Loss: 1759859712.0, lr: 0.006239711749116511, time: 70
Epochs: 66, Loss: 1749318272.0, lr: 0.006184288810627978, time: 70
Epochs: 67, Loss: 1738832640.0, lr: 0.006128948531931931, time: 70
Epochs: 68, Loss: 1728501632.0, lr: 0.006073691409865798, time: 70
Epochs: 69, Loss: 1718372992.0, lr: 0.006018517948037141, time: 70
Epochs: 70, Loss: 1760625792.0, lr: 0.005963428656968238, time: 71
Epochs: 71, Loss: 1749544704.0, lr: 0.005908424054244922, time: 71
Epochs: 72, Loss: 1738464256.0, lr: 0.005853504664669777, time: 71
Epochs: 73, Loss: 1727350272.0, lr: 0.005798671020419897, time: 71
Epochs: 74, Loss: 1716085632.0, lr: 0.00574392366120934, time: 71
Epochs: 75, Loss: 1756388224.0, lr: 0.0056892631344565014, time: 72
Epochs: 76, Loss: 1743672320.0, lr: 0.005634689995456556, time: 72
Epochs: 77, Loss: 1730765952.0, lr: 0.005580204807559186, time: 72
Epochs: 78, Loss: 1717702400.0, lr: 0.005525808142351796, time: 72
Epochs: 79, Loss: 1704447360.0, lr: 0.005471500579848428, time: 72
Epochs: 80, Loss: 1741878656.0, lr: 0.005417282708684606, time: 73
Epochs: 81, Loss: 1727041024.0, lr: 0.005363155126318348, time: 73
Epochs: 82, Loss: 1711838464.0, lr: 0.005309118439237588, time: 73
Epochs: 83, Loss: 1696360704.0, lr: 0.0052551732631742724, time: 73
Epochs: 84, Loss: 1680791808.0, lr: 0.005201320223325415, time: 73
Epochs: 85, Loss: 1712599168.0, lr: 0.0051475599545813665, time: 74
Epochs: 86, Loss: 1694568064.0, lr: 0.005093893101761646, time: 74
Epochs: 87, Loss: 1682890880.0, lr: 0.0050403203198586, time: 74
Epochs: 88, Loss: 1665991680.0, lr: 0.004986842274289281, time: 74
Epochs: 89, Loss: 1649192960.0, lr: 0.00493345964115583, time: 74
Epochs: 90, Loss: 1676525952.0, lr: 0.004880173107514794, time: 75
Epochs: 91, Loss: 1658007552.0, lr: 0.00482698337165572, time: 75
Epochs: 92, Loss: 1639751424.0, lr: 0.004773891143389472, time: 75
Epochs: 93, Loss: 1622074880.0, lr: 0.004720897144346658, time: 75
Epochs: 94, Loss: 1604055296.0, lr: 0.004668002108286678, time: 75
Epochs: 95, Loss: 1626602496.0, lr: 0.004615206781417809, time: 76
Epochs: 96, Loss: 1606920192.0, lr: 0.004562511922728894, time: 76
Epochs: 97, Loss: 1587330432.0, lr: 0.004509918304333114, time: 76
Epochs: 98, Loss: 1567808768.0, lr: 0.00445742671182445, time: 76
Epochs: 99, Loss: 1552410496.0, lr: 0.004405037944647404, time: 76
Epochs: 100, Loss: 1570932736.0, lr: 0.004352752816480621, time: 77
Epochs: 101, Loss: 1549818496.0, lr: 0.00430057215563507, time: 77
Epochs: 102, Loss: 1528692992.0, lr: 0.004248496805467505, time: 77
Epochs: 103, Loss: 1507298560.0, lr: 0.004196527624809932, time: 77
Epochs: 104, Loss: 1486168064.0, lr: 0.004144665488415892, time: 77
Epochs: 105, Loss: 1498120448.0, lr: 0.004092911287424392, time: 78
Epochs: 106, Loss: 1475615744.0, lr: 0.0040412659298423685, time: 78
Epochs: 107, Loss: 1453462784.0, lr: 0.003989730341046647, time: 78
Epochs: 108, Loss: 1430488192.0, lr: 0.003938305464306383, time: 78
Epochs: 109, Loss: 1409250048.0, lr: 0.0038869922613270673, time: 78
Epochs: 110, Loss: 1415095296.0, lr: 0.003835791712817216, time: 79
Epochs: 111, Loss: 1391182976.0, lr: 0.003784704819078975, time: 79
Epochs: 112, Loss: 1362857216.0, lr: 0.0037337326006239083, time: 79
Epochs: 113, Loss: 1351350016.0, lr: 0.0036828760988153516, time: 79
Epochs: 114, Loss: 1353242496.0, lr: 0.003632136376538792, time: 79
Epochs: 115, Loss: 1370679040.0, lr: 0.003581514518901845, time: 80
Epochs: 116, Loss: 1512335616.0, lr: 0.0035310116339654822, time: 80
Epochs: 117, Loss: 1580582912.0, lr: 0.003480628853508311, time: 80
Epochs: 118, Loss: 1695999360.0, lr: 0.003430367333825799, time: 80
Epochs: 119, Loss: 1819725952.0, lr: 0.0033802282565665053, time: 80
Epochs: 120, Loss: 2070498304.0, lr: 0.003330212829607493, time: 81
Epochs: 121, Loss: 2084399872.0, lr: 0.003280322287971276, time: 81
Epochs: 122, Loss: 2176221696.0, lr: 0.00323055789478683, time: 81
Epochs: 123, Loss: 2175991552.0, lr: 0.003180920942297357, time: 81
Epochs: 124, Loss: 2137457152.0, lr: 0.0031314127529177404, time: 81
Epochs: 125, Loss: 2144466816.0, lr: 0.0030820346803447987, time: 82
Epochs: 126, Loss: 2027499008.0, lr: 0.0030327881107237308, time: 82
Epochs: 127, Loss: 1815140608.0, lr: 0.002983674463874393, time: 82
Epochs: 128, Loss: 1680504192.0, lr: 0.002934695194581322, time: 82
Epochs: 129, Loss: 1498215424.0, lr: 0.0028858517939517685, time: 82
Epochs: 130, Loss: 1508452480.0, lr: 0.0028371457908463217, time: 83
Epochs: 131, Loss: 1329778176.0, lr: 0.0027885787533870952, time: 83
Epochs: 132, Loss: 1329028608.0, lr: 0.0027401522905488723, time: 83
Epochs: 133, Loss: 1317581312.0, lr: 0.0026918680538390517, time: 83
Epochs: 134, Loss: 1286208512.0, lr: 0.0026437277390727503, time: 83
Epochs: 135, Loss: 1289639296.0, lr: 0.002595733088249974, time: 84
Epochs: 136, Loss: 1296356352.0, lr: 0.0025478858915423818, time: 84
Epochs: 137, Loss: 1298769152.0, lr: 0.0025001879893978628, time: 84
Epochs: 138, Loss: 1268769664.0, lr: 0.0024526412747718704, time: 84
Epochs: 139, Loss: 1328025216.0, lr: 0.0024052476954953333, time: 84
Epochs: 140, Loss: 1393730560.0, lr: 0.0023580092567898688, time: 85
Epochs: 141, Loss: 1422712192.0, lr: 0.002310928023942061, time: 85
Epochs: 142, Loss: 1453161600.0, lr: 0.002264006125149731, time: 85
Epochs: 143, Loss: 1480719616.0, lr: 0.0022172457545544207, time: 85
Epochs: 144, Loss: 1463230976.0, lr: 0.0021706491754757296, time: 85
Epochs: 145, Loss: 1540355328.0, lr: 0.0021242187238648003, time: 86
Epochs: 146, Loss: 1536220416.0, lr: 0.0020779568119960413, time: 86
Epochs: 147, Loss: 1667442048.0, lr: 0.002031865932418231, time: 86
Epochs: 148, Loss: 1647499264.0, lr: 0.0019859486621884607, time: 86
Epochs: 149, Loss: 1628861696.0, lr: 0.0019402076674149827, time: 86
Epochs: 150, Loss: 1743537920.0, lr: 0.0018946457081379978, time: 87
Epochs: 151, Loss: 1747032576.0, lr: 0.0018492656435807604, time: 87
Epochs: 152, Loss: 1725831808.0, lr: 0.0018040704378072304, time: 87
Epochs: 153, Loss: 1703472000.0, lr: 0.0017590631658268541, time: 87
Epochs: 154, Loss: 1684162560.0, lr: 0.001714247020192063, time: 87
Epochs: 155, Loss: 1834152704.0, lr: 0.001669625318139816, time: 88
Epochs: 156, Loss: 1948248704.0, lr: 0.0016252015093351226, time: 88
Epochs: 157, Loss: 1937296512.0, lr: 0.0015809791842820939, time: 88
Epochs: 158, Loss: 1958510336.0, lr: 0.0015369620834769088, time: 88
Epochs: 159, Loss: 2004191360.0, lr: 0.0014931541073873358, time: 88
Epochs: 160, Loss: 2116641024.0, lr: 0.0014495593273553908, time: 89
Epochs: 161, Loss: 2382695680.0, lr: 0.0014061819975337074, time: 89
Epochs: 162, Loss: 2487504128.0, lr: 0.0013630265679826026, time: 89
Epochs: 163, Loss: 2474809856.0, lr: 0.0013200976990741667, time: 89
Epochs: 164, Loss: 2363616000.0, lr: 0.0012774002773725999, time: 89
Epochs: 165, Loss: 2433004032.0, lr: 0.0012349394331872471, time: 90
Epochs: 166, Loss: 2597995264.0, lr: 0.0011927205600272433, time: 90
Epochs: 167, Loss: 2664706048.0, lr: 0.0011507493362256864, time: 90
Epochs: 168, Loss: 2652346624.0, lr: 0.0011090317490482346, time: 90
Epochs: 169, Loss: 2634363648.0, lr: 0.0010675741216579879, time: 90
Epochs: 170, Loss: 2732146176.0, lr: 0.0010263831433779478, time: 91
Epochs: 171, Loss: 2711666944.0, lr: 0.000985465903777487, time: 91
Epochs: 172, Loss: 2759031808.0, lr: 0.0009448299312143319, time: 91
Epochs: 173, Loss: 2810618368.0, lr: 0.0009044832365940862, time: 91
Epochs: 174, Loss: 2794565632.0, lr: 0.0008644343632726742, time: 91
Epochs: 175, Loss: 2904641280.0, lr: 0.000824692444233059, time: 92
Epochs: 176, Loss: 2969530368.0, lr: 0.0007852672679294849, time: 92
########## Saving Trace ##########
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 198, in <module>
    traj, dtraj_dt = odeint(dyn_system, x_init, time, method='euler', options=dict(step_size=dt))
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 209, in odeint_adjoint
    adjoint_method, adjoint_options, t.requires_grad, *adjoint_params)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 23, in forward
    ans, ans_dt = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/odeint.py", line 57, in odeint
    solution, solution_dt = solver.integrate(t)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/solvers.py", line 72, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/fixed_grid.py", line 9, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1208, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 165, in forward
    u = self._ctrl(t, x)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 123, in hjb
    return self._policy(q, v, x, Vx)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 77, in underactuated_inv_policy
    Mu, Mua = self._dynamics._Mu_Mua(q)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 163, in _Mu_Mua
    Mu, Mua = M[:, 1, 1].clone().view(q.shape[0], 1, 1), M[:, 0, 1].clone().view(q.shape[0], 1, 1)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 239, in <module>
    model_scripted = torch.jit.script(dyn_system.value_func.to('cpu'))  # Export to TorchScript
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_script.py", line 1287, in script
    obj, torch.jit._recursive.infer_methods_to_compile
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 476, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 393, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError:
attribute lookup is not defined on python value of type 'SimulationParams':
  File "tv_value_synthesis_trajopt_cartpole.py", line 74
    def forward(self, t, x):
        time = torch.ones((sim_params.nsim, 1, 1)).to(device) * t
                           ~~~~~~~~~~~~~~~ <--- HERE
        aug_x = torch.cat((x, time), dim=2)
        return self.nn(aug_x)