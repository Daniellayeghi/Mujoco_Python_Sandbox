
Creating window glfw
Epochs: 1, Loss: 1161724800.0, lr: 0.004, time: 75
Epochs: 2, Loss: 1129114624.0, lr: 0.004, time: 75
Epochs: 3, Loss: 1114407040.0, lr: 0.004, time: 75
Epochs: 4, Loss: 1099122176.0, lr: 0.004, time: 75
Epochs: 5, Loss: 1083463936.0, lr: 0.004, time: 75
Epochs: 6, Loss: 1067161664.0, lr: 0.004, time: 75
Epochs: 7, Loss: 1050639872.0, lr: 0.004, time: 75
Epochs: 8, Loss: 1033804928.0, lr: 0.004, time: 75
Epochs: 9, Loss: 1016826624.0, lr: 0.004, time: 75
Epochs: 10, Loss: 999125248.0, lr: 0.004, time: 75
Epochs: 11, Loss: 981257600.0, lr: 0.004, time: 75
Epochs: 12, Loss: 962778240.0, lr: 0.004, time: 75
Epochs: 13, Loss: 943594880.0, lr: 0.004, time: 75
Epochs: 14, Loss: 923671488.0, lr: 0.004, time: 75
Epochs: 15, Loss: 903341504.0, lr: 0.004, time: 75
Epochs: 16, Loss: 882290752.0, lr: 0.004, time: 75
Epochs: 17, Loss: 860829696.0, lr: 0.004, time: 75
Epochs: 18, Loss: 838821760.0, lr: 0.004, time: 75
Epochs: 19, Loss: 816461376.0, lr: 0.004, time: 75
Epochs: 20, Loss: 793351552.0, lr: 0.004, time: 75
Epochs: 21, Loss: 769748800.0, lr: 0.004, time: 75
Epochs: 22, Loss: 745676864.0, lr: 0.004, time: 75
Epochs: 23, Loss: 721510528.0, lr: 0.004, time: 75
Epochs: 24, Loss: 697138304.0, lr: 0.004, time: 75
Epochs: 25, Loss: 673142784.0, lr: 0.004, time: 75
Epochs: 26, Loss: 649114688.0, lr: 0.004, time: 76
Epochs: 27, Loss: 624952704.0, lr: 0.004, time: 76
Epochs: 28, Loss: 601231808.0, lr: 0.004, time: 78
Epochs: 29, Loss: 576679808.0, lr: 0.004, time: 78
Epochs: 30, Loss: 553478208.0, lr: 0.004, time: 79
Epochs: 31, Loss: 530670688.0, lr: 0.004, time: 80
Epochs: 32, Loss: 508736128.0, lr: 0.004, time: 80
Epochs: 33, Loss: 486867872.0, lr: 0.004, time: 81
Epochs: 34, Loss: 465708320.0, lr: 0.004, time: 82
Epochs: 35, Loss: 446070912.0, lr: 0.004, time: 82
Epochs: 36, Loss: 429348992.0, lr: 0.004, time: 84
Epochs: 37, Loss: 414846720.0, lr: 0.004, time: 84
Epochs: 38, Loss: 411312960.0, lr: 0.004, time: 84
Epochs: 39, Loss: 392282272.0, lr: 0.004, time: 85
Epochs: 40, Loss: 386638048.0, lr: 0.004, time: 85
Epochs: 41, Loss: 371154496.0, lr: 0.004, time: 85
Epochs: 42, Loss: 360645344.0, lr: 0.004, time: 85
Epochs: 43, Loss: 352111904.0, lr: 0.004, time: 85
Epochs: 44, Loss: 344726336.0, lr: 0.004, time: 85
Epochs: 45, Loss: 338060480.0, lr: 0.004, time: 85
Epochs: 46, Loss: 331867296.0, lr: 0.004, time: 85
Epochs: 47, Loss: 325938464.0, lr: 0.004, time: 85
Epochs: 48, Loss: 320181920.0, lr: 0.004, time: 85
Epochs: 49, Loss: 314551296.0, lr: 0.004, time: 85
Epochs: 50, Loss: 309025440.0, lr: 0.004, time: 85
Epochs: 51, Loss: 303677056.0, lr: 0.004, time: 85
Epochs: 52, Loss: 299039392.0, lr: 0.004, time: 85
Epochs: 53, Loss: 293258624.0, lr: 0.004, time: 85
Epochs: 54, Loss: 289904704.0, lr: 0.004, time: 85
Epochs: 55, Loss: 281827776.0, lr: 0.004, time: 85
Epochs: 56, Loss: 275744192.0, lr: 0.004, time: 85
Epochs: 57, Loss: 270183520.0, lr: 0.004, time: 85
Epochs: 58, Loss: 264919280.0, lr: 0.004, time: 85
Epochs: 59, Loss: 259905136.0, lr: 0.004, time: 85
Epochs: 60, Loss: 255149456.0, lr: 0.004, time: 85
Epochs: 61, Loss: 250514992.0, lr: 0.004, time: 85
Epochs: 62, Loss: 246174432.0, lr: 0.004, time: 85
Epochs: 63, Loss: 241928480.0, lr: 0.004, time: 85
Epochs: 64, Loss: 237839472.0, lr: 0.004, time: 85
Epochs: 65, Loss: 233951024.0, lr: 0.004, time: 85
Epochs: 66, Loss: 230130944.0, lr: 0.004, time: 85
Epochs: 67, Loss: 226416096.0, lr: 0.004, time: 85
Epochs: 68, Loss: 222781376.0, lr: 0.004, time: 85
Epochs: 69, Loss: 219219248.0, lr: 0.004, time: 85
Epochs: 70, Loss: 215732976.0, lr: 0.004, time: 85
Epochs: 71, Loss: 212275472.0, lr: 0.004, time: 85
Epochs: 72, Loss: 208856416.0, lr: 0.004, time: 85
Epochs: 73, Loss: 205477664.0, lr: 0.004, time: 85
Epochs: 74, Loss: 202143440.0, lr: 0.004, time: 85
Epochs: 75, Loss: 198860208.0, lr: 0.004, time: 85
Epochs: 76, Loss: 195638864.0, lr: 0.004, time: 85
Epochs: 77, Loss: 192484240.0, lr: 0.004, time: 85
Epochs: 78, Loss: 189409568.0, lr: 0.004, time: 85
Epochs: 79, Loss: 186421840.0, lr: 0.004, time: 85
Epochs: 80, Loss: 183534992.0, lr: 0.004, time: 85
Epochs: 81, Loss: 180740416.0, lr: 0.004, time: 85
Epochs: 82, Loss: 178049856.0, lr: 0.004, time: 85
Epochs: 83, Loss: 175463872.0, lr: 0.004, time: 85
Epochs: 84, Loss: 172982256.0, lr: 0.004, time: 85
Epochs: 85, Loss: 170596032.0, lr: 0.004, time: 85
Epochs: 86, Loss: 168305024.0, lr: 0.004, time: 85
Epochs: 87, Loss: 166105824.0, lr: 0.004, time: 85
Epochs: 88, Loss: 163990896.0, lr: 0.004, time: 85
Epochs: 89, Loss: 161955600.0, lr: 0.004, time: 85
Epochs: 90, Loss: 159987904.0, lr: 0.004, time: 85
Epochs: 91, Loss: 158092496.0, lr: 0.004, time: 85
Epochs: 92, Loss: 156260176.0, lr: 0.004, time: 85
Epochs: 93, Loss: 154487456.0, lr: 0.004, time: 85
Epochs: 94, Loss: 152767056.0, lr: 0.004, time: 85
Epochs: 95, Loss: 151096080.0, lr: 0.004, time: 85
Epochs: 96, Loss: 149463296.0, lr: 0.004, time: 85
Epochs: 97, Loss: 147872944.0, lr: 0.004, time: 85
Epochs: 98, Loss: 146312960.0, lr: 0.004, time: 85
Epochs: 99, Loss: 144778544.0, lr: 0.004, time: 85
Epochs: 100, Loss: 143257600.0, lr: 0.004, time: 85
Epochs: 101, Loss: 141764592.0, lr: 0.004, time: 85
Epochs: 102, Loss: 140268592.0, lr: 0.004, time: 85
Epochs: 103, Loss: 138772112.0, lr: 0.004, time: 85
Epochs: 104, Loss: 137280960.0, lr: 0.004, time: 85
Epochs: 105, Loss: 135787056.0, lr: 0.004, time: 85
Epochs: 106, Loss: 134308128.0, lr: 0.004, time: 85
Epochs: 107, Loss: 132810256.0, lr: 0.004, time: 85
Epochs: 108, Loss: 131325072.0, lr: 0.004, time: 85
Epochs: 109, Loss: 129842248.0, lr: 0.004, time: 85
Epochs: 110, Loss: 128381192.0, lr: 0.004, time: 85
Epochs: 111, Loss: 126908488.0, lr: 0.004, time: 85
Epochs: 112, Loss: 125444496.0, lr: 0.004, time: 85
Epochs: 113, Loss: 123978632.0, lr: 0.004, time: 85
Epochs: 114, Loss: 122526064.0, lr: 0.004, time: 85
Epochs: 115, Loss: 121076144.0, lr: 0.004, time: 85
Epochs: 116, Loss: 119704800.0, lr: 0.004, time: 85
Epochs: 117, Loss: 118434616.0, lr: 0.004, time: 85
Epochs: 118, Loss: 117450392.0, lr: 0.004, time: 85
Epochs: 119, Loss: 116252800.0, lr: 0.004, time: 85
Epochs: 120, Loss: 115557768.0, lr: 0.004, time: 85
Epochs: 121, Loss: 115792104.0, lr: 0.004, time: 85
Epochs: 122, Loss: 117965312.0, lr: 0.004, time: 85
Epochs: 123, Loss: 118100192.0, lr: 0.004, time: 85
Epochs: 124, Loss: 117039536.0, lr: 0.004, time: 85
Epochs: 125, Loss: 118127792.0, lr: 0.004, time: 85
Epochs: 126, Loss: 118594840.0, lr: 0.004, time: 85
Epochs: 127, Loss: 117653456.0, lr: 0.004, time: 85
Epochs: 128, Loss: 116763152.0, lr: 0.004, time: 85
Epochs: 129, Loss: 115881728.0, lr: 0.004, time: 85
Epochs: 130, Loss: 115134480.0, lr: 0.004, time: 85
Epochs: 131, Loss: 112761360.0, lr: 0.004, time: 85
Epochs: 132, Loss: 110222128.0, lr: 0.004, time: 85
Epochs: 133, Loss: 109604672.0, lr: 0.004, time: 85
Epochs: 134, Loss: 108010792.0, lr: 0.004, time: 85
Epochs: 135, Loss: 104969768.0, lr: 0.004, time: 85
Epochs: 136, Loss: 104243504.0, lr: 0.004, time: 85
Epochs: 137, Loss: 103160320.0, lr: 0.004, time: 85
Epochs: 138, Loss: 101594112.0, lr: 0.004, time: 85
Epochs: 139, Loss: 100810296.0, lr: 0.004, time: 85
Epochs: 140, Loss: 100220472.0, lr: 0.004, time: 85
Epochs: 141, Loss: 101420776.0, lr: 0.004, time: 85
Epochs: 142, Loss: 98888856.0, lr: 0.004, time: 85
Epochs: 143, Loss: 98219400.0, lr: 0.004, time: 85
Epochs: 144, Loss: 98792456.0, lr: 0.004, time: 85
Epochs: 145, Loss: 99770888.0, lr: 0.004, time: 85
Epochs: 146, Loss: 99191760.0, lr: 0.004, time: 85
Epochs: 147, Loss: 98245976.0, lr: 0.004, time: 85
Epochs: 148, Loss: 97572832.0, lr: 0.004, time: 85
Epochs: 149, Loss: 96972528.0, lr: 0.004, time: 85
Epochs: 150, Loss: 96494976.0, lr: 0.004, time: 85
Epochs: 151, Loss: 100572992.0, lr: 0.004, time: 85
Epochs: 152, Loss: 95883008.0, lr: 0.004, time: 85
Epochs: 153, Loss: 94575440.0, lr: 0.004, time: 85
Epochs: 154, Loss: 94757976.0, lr: 0.004, time: 85
Epochs: 155, Loss: 93224136.0, lr: 0.004, time: 85
Epochs: 156, Loss: 91920784.0, lr: 0.004, time: 85
Epochs: 157, Loss: 91354256.0, lr: 0.004, time: 85
Epochs: 158, Loss: 90951224.0, lr: 0.004, time: 85
Epochs: 159, Loss: 90722696.0, lr: 0.004, time: 85
Epochs: 160, Loss: 91304920.0, lr: 0.004, time: 85
Epochs: 161, Loss: 92015560.0, lr: 0.004, time: 85
Epochs: 162, Loss: 92224376.0, lr: 0.004, time: 85
Epochs: 163, Loss: 89370968.0, lr: 0.004, time: 85
Epochs: 164, Loss: 89760376.0, lr: 0.004, time: 85
Epochs: 165, Loss: 89884728.0, lr: 0.004, time: 85
Epochs: 166, Loss: 87964080.0, lr: 0.004, time: 85
Epochs: 167, Loss: 86856992.0, lr: 0.004, time: 85
Epochs: 168, Loss: 86063488.0, lr: 0.004, time: 85
Epochs: 169, Loss: 85711080.0, lr: 0.004, time: 85
Epochs: 170, Loss: 82833728.0, lr: 0.004, time: 85
Epochs: 171, Loss: 82375008.0, lr: 0.004, time: 85
Epochs: 172, Loss: 82841040.0, lr: 0.004, time: 85
Epochs: 173, Loss: 82220840.0, lr: 0.004, time: 85
Epochs: 174, Loss: 83374576.0, lr: 0.004, time: 85
Epochs: 175, Loss: 82720088.0, lr: 0.004, time: 85
Epochs: 176, Loss: 81655216.0, lr: 0.004, time: 85
Epochs: 177, Loss: 81069760.0, lr: 0.004, time: 85
Epochs: 178, Loss: 80540408.0, lr: 0.004, time: 85
Epochs: 179, Loss: 80006048.0, lr: 0.004, time: 85
Epochs: 180, Loss: 79630240.0, lr: 0.004, time: 85
Epochs: 181, Loss: 79433992.0, lr: 0.004, time: 85
Epochs: 182, Loss: 77988480.0, lr: 0.004, time: 85
Epochs: 183, Loss: 77284720.0, lr: 0.004, time: 85
Epochs: 184, Loss: 77509392.0, lr: 0.004, time: 85
########## Saving Trace ##########
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 224, in <module>
    sim_params.ntime = optimal_time(sim_params.ntime, max_time, dt, loss_function, x_init, dyn_system, loss)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/time_search.py", line 33, in optimal_time
    return bisection_search(func_wrap, criteria, init_time, max_time)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/time_search.py", line 14, in bisection_search
    if criteria(func(mid)):
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/time_search.py", line 26, in func_wrap
    y, dydt = odeint(func, x_init, time, method='euler', options=dict(step_size=dt))
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 209, in odeint_adjoint
    adjoint_method, adjoint_options, t.requires_grad, *adjoint_params)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 23, in forward
    ans, ans_dt = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/odeint.py", line 57, in odeint
    solution, solution_dt = solver.integrate(t)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/solvers.py", line 72, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/fixed_grid.py", line 9, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1208, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 165, in forward
    u = self._ctrl(t, x)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 123, in hjb
    return self._policy(q, v, x, Vx)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 77, in underactuated_inv_policy
    Mu, Mua = self._dynamics._Mu_Mua(q)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 162, in _Mu_Mua
    M = self._Mfull(q)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 157, in _Mfull
    Mlow = self._Muact(q)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/models.py", line 140, in _Muact
    M22 = (self.MASS_P * self.LENGTH ** 2) * torch.ones_like(qp)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 262, in <module>
    model_scripted = torch.jit.script(dyn_system.value_func.to('cpu'))  # Export to TorchScript
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_script.py", line 1287, in script
    obj, torch.jit._recursive.infer_methods_to_compile
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 476, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 393, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError:
attribute lookup is not defined on python value of type 'SimulationParams':
  File "tv_value_synthesis_trajopt_cartpole.py", line 75
    def forward(self, t, x):
        time = torch.ones((sim_params.nsim, 1, 1)).to(device) * t
                           ~~~~~~~~~~~~~~~ <--- HERE
        aug_x = torch.cat((x, time), dim=2)
        return self.nn(aug_x)