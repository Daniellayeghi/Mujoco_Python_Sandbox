Creating window glfw
Epochs: 1, Loss: 12413957120.0, lr: 0.004, time: 50, 0
Epochs: 2, Loss: 12270187520.0, lr: 0.004, time: 50, 0
Epochs: 3, Loss: 12127284224.0, lr: 0.004, time: 50, 0
Epochs: 4, Loss: 11984773120.0, lr: 0.004, time: 50, 0
Epochs: 5, Loss: 11845576704.0, lr: 0.004, time: 50, 0
Epochs: 6, Loss: 11711099904.0, lr: 0.004, time: 50, 0
Epochs: 7, Loss: 11577068544.0, lr: 0.004, time: 50, 0
Epochs: 8, Loss: 11444919296.0, lr: 0.004, time: 50, 0
Epochs: 9, Loss: 11311302656.0, lr: 0.004, time: 50, 0
Epochs: 10, Loss: 11180560384.0, lr: 0.004, time: 50, 0
Epochs: 11, Loss: 11049066496.0, lr: 0.004, time: 50, -1370440817.777778
Epochs: 12, Loss: 10913080320.0, lr: 0.004, time: 50, -1363620977.777778
Epochs: 13, Loss: 10778518528.0, lr: 0.004, time: 50, -1358785801.4814816
Epochs: 14, Loss: 10641353728.0, lr: 0.004, time: 50, -1354160071.1111112
Epochs: 15, Loss: 10502490112.0, lr: 0.004, time: 50, -1350933162.6666667
Epochs: 16, Loss: 10358111232.0, lr: 0.004, time: 50, -1349594263.7037039
Epochs: 17, Loss: 10213826560.0, lr: 0.004, time: 50, -1350280370.793651
Epochs: 18, Loss: 10064814080.0, lr: 0.004, time: 50, -1352480426.666667
Epochs: 19, Loss: 9913100288.0, lr: 0.004, time: 50, -1356092302.2222223
Epochs: 20, Loss: 9757902848.0, lr: 0.004, time: 50, -1361311971.5555558
Epochs: 21, Loss: 9605735424.0, lr: 0.004, time: 50, -1367976908.2828283
Epochs: 22, Loss: 9443706880.0, lr: 0.004, time: 50, -1375029285.925926
Epochs: 23, Loss: 9279538176.0, lr: 0.004, time: 50, -1383344268.0341883
Epochs: 24, Loss: 9117295616.0, lr: 0.004, time: 50, -1392614562.5396826
Epochs: 25, Loss: 8942061568.0, lr: 0.004, time: 50, -1402380591.4074075
Epochs: 26, Loss: 8766611456.0, lr: 0.004, time: 50, -1413068586.666667
Epochs: 27, Loss: 8590148608.0, lr: 0.004, time: 50, -1424536127.5816996
Epochs: 28, Loss: 8409738752.0, lr: 0.004, time: 50, -1436423964.4444447
Epochs: 29, Loss: 8215993856.0, lr: 0.004, time: 50, -1448738582.4561405
Epochs: 30, Loss: 8034577920.0, lr: 0.004, time: 50, -1461963264.0000002
Epochs: 31, Loss: 7839250944.0, lr: 0.004, time: 50, -1475475992.3809526
Epochs: 32, Loss: 7650323968.0, lr: 0.004, time: 50, -1489442029.8989902
Epochs: 33, Loss: 7451229184.0, lr: 0.004, time: 50, -1503389681.1594205
Epochs: 34, Loss: 7254110720.0, lr: 0.004, time: 50, -1517881149.6296299
Epochs: 35, Loss: 7052541952.0, lr: 0.004, time: 50, -1532185941.3333335
Epochs: 36, Loss: 6851271168.0, lr: 0.004, time: 50, -1546506546.3247867
Epochs: 37, Loss: 6658723328.0, lr: 0.004, time: 50, -1560787268.4773664
Epochs: 38, Loss: 6467152896.0, lr: 0.004, time: 50, -1574529605.0793653
Epochs: 39, Loss: 6274038784.0, lr: 0.004, time: 50, -1587240881.5325673
Epochs: 40, Loss: 6086719488.0, lr: 0.004, time: 50, -1599538005.3333335
Epochs: 41, Loss: 5892858880.0, lr: 0.004, time: 50, -1610754752.6881723
Epochs: 42, Loss: 5717946880.0, lr: 0.004, time: 50, -1621441760.0000002
Epochs: 43, Loss: 5549769216.0, lr: 0.004, time: 50, -1630666834.747475
Epochs: 44, Loss: 5387387904.0, lr: 0.004, time: 50, -1638403480.2614381
Epochs: 45, Loss: 5234407936.0, lr: 0.004, time: 50, -1644453985.5238097
Epochs: 46, Loss: 5032768512.0, lr: 0.004, time: 50, -1648677894.3209877
Epochs: 47, Loss: 4886445568.0, lr: 0.004, time: 50, -1652946504.2642643
Epochs: 48, Loss: 4753798144.0, lr: 0.004, time: 50, -1655667424.5614035
Epochs: 49, Loss: 4636760064.0, lr: 0.004, time: 50, -1656526112.8205128
Epochs: 50, Loss: 4464609792.0, lr: 0.004, time: 50, -1655389610.6666665
Epochs: 51, Loss: 4326445056.0, lr: 0.004, time: 50, -1653720191.6531165
Epochs: 52, Loss: 4228496128.0, lr: 0.004, time: 50, -1651158118.941799
Epochs: 53, Loss: 4083520512.0, lr: 0.004, time: 50, -1646900516.382429
Epochs: 54, Loss: 3983583488.0, lr: 0.004, time: 50, -1642396903.4343436
Epochs: 55, Loss: 3899979520.0, lr: 0.004, time: 50, -1636783748.740741
Epochs: 56, Loss: 3825510400.0, lr: 0.004, time: 50, -1628563546.2801936
Epochs: 57, Loss: 3756720128.0, lr: 0.004, time: 50, -1618994467.706856
Epochs: 58, Loss: 3636685824.0, lr: 0.004, time: 50, -1608345925.9259262
Epochs: 59, Loss: 3561211648.0, lr: 0.004, time: 50, -1598199960.0907032
Epochs: 60, Loss: 3495009792.0, lr: 0.004, time: 50, -1586311475.2000003
Epochs: 61, Loss: 3430961152.0, lr: 0.004, time: 50, -1573321386.666667
Epochs: 62, Loss: 3377067008.0, lr: 0.004, time: 50, -1560106551.794872
Epochs: 63, Loss: 3327622912.0, lr: 0.004, time: 50, -1545480925.115304
Epochs: 64, Loss: 3283915520.0, lr: 0.004, time: 50, -1530358039.1769547
Epochs: 65, Loss: 3242566400.0, lr: 0.004, time: 50, -1514979084.929293
Epochs: 66, Loss: 3204283904.0, lr: 0.004, time: 50, -1499492236.1904762
Epochs: 67, Loss: 3173253120.0, lr: 0.004, time: 50, -1483954092.1637428
Epochs: 68, Loss: 3139781120.0, lr: 0.004, time: 50, -1467246697.9310348
Epochs: 69, Loss: 3107747840.0, lr: 0.004, time: 50, -1450314654.6139364
Epochs: 70, Loss: 3078024960.0, lr: 0.004, time: 50, -1433314261.3333335
Epochs: 71, Loss: 3048915712.0, lr: 0.004, time: 50, -1416246016.4663026
Epochs: 72, Loss: 3020990208.0, lr: 0.004, time: 50, -1399284186.3799286
Epochs: 73, Loss: 2994471936.0, lr: 0.004, time: 50, -1382481310.4761908
Epochs: 74, Loss: 2968092416.0, lr: 0.004, time: 50, -1365905102.2222226
Epochs: 75, Loss: 2942617856.0, lr: 0.004, time: 50, -1349583040.5470088
Epochs: 76, Loss: 2917733376.0, lr: 0.004, time: 50, -1333539964.9831653
Epochs: 77, Loss: 2892714240.0, lr: 0.004, time: 50, -1317873858.441128
Epochs: 78, Loss: 2868206592.0, lr: 0.004, time: 50, -1302530401.0457518
Epochs: 79, Loss: 2844251648.0, lr: 0.004, time: 50, -1287510495.845411
Epochs: 80, Loss: 2819771904.0, lr: 0.004, time: 50, -1272828176.2539685
Epochs: 81, Loss: 2795880704.0, lr: 0.004, time: 50, -1258486993.9280128
Epochs: 82, Loss: 2772652800.0, lr: 0.004, time: 50, -1244481920.0000005
Epochs: 83, Loss: 2748790528.0, lr: 0.004, time: 50, -1230810465.0228314
Epochs: 84, Loss: 2725594368.0, lr: 0.004, time: 50, -1217470712.3123128
Epochs: 85, Loss: 2702459136.0, lr: 0.004, time: 50, -1204452932.2666671
Epochs: 86, Loss: 2680182784.0, lr: 0.004, time: 50, -1191752151.5789478
Epochs: 87, Loss: 2658212096.0, lr: 0.004, time: 50, -1179341682.8860033
Epochs: 88, Loss: 2636225024.0, lr: 0.004, time: 50, -1167213292.3076928
Epochs: 89, Loss: 2614298368.0, lr: 0.004, time: 50, -1155364272.0675108
Epochs: 90, Loss: 2593067520.0, lr: 0.004, time: 50, -1143776017.7777781
Epochs: 91, Loss: 2571802112.0, lr: 0.004, time: 50, -1132437400.0548701
Epochs: 92, Loss: 2551169024.0, lr: 0.004, time: 50, -1121348741.8970194
Epochs: 93, Loss: 2530576384.0, lr: 0.004, time: 50, -1110484051.619813
Epochs: 94, Loss: 2511230464.0, lr: 0.004, time: 50, -1099843606.3492067
Epochs: 95, Loss: 2490988288.0, lr: 0.004, time: 50, -1089403991.0065362
Epochs: 96, Loss: 2471011584.0, lr: 0.004, time: 50, -1079180876.072352
Epochs: 97, Loss: 2451132928.0, lr: 0.004, time: 50, -1069167309.3231167
Epochs: 98, Loss: 2432488448.0, lr: 0.004, time: 50, -1059354702.2222226
Epochs: 99, Loss: 2413056768.0, lr: 0.004, time: 50, -1049721627.1660429
Epochs: 100, Loss: 2394269952.0, lr: 0.004, time: 50, -1040280408.4938277
Epochs: 101, Loss: 2377846784.0, lr: 0.004, time: 50, -1031016425.494506
Epochs: 102, Loss: 2359163136.0, lr: 0.004, time: 50, -1021902988.9855078
Epochs: 103, Loss: 2340585472.0, lr: 0.004, time: 50, -1012962732.8076469
Epochs: 104, Loss: 2322144256.0, lr: 0.004, time: 50, -1004203613.8061471
Epochs: 105, Loss: 2304434176.0, lr: 0.004, time: 50, -995607833.450293
Epochs: 106, Loss: 2286956544.0, lr: 0.004, time: 50, -987164897.7777783
Epochs: 107, Loss: 2269500416.0, lr: 0.004, time: 50, -978868540.1145481
Epochs: 108, Loss: 2252303616.0, lr: 0.004, time: 50, -970728022.4943315
Epochs: 109, Loss: 2236079360.0, lr: 0.004, time: 50, -962726876.9472507
Epochs: 110, Loss: 2219023104.0, lr: 0.004, time: 50, -954857281.4222226
Epochs: 111, Loss: 2202425856.0, lr: 0.004, time: 50, -947150484.136414
Epochs: 112, Loss: 2186781696.0, lr: 0.004, time: 50, -939572072.8540308
Epochs: 113, Loss: 2171198720.0, lr: 0.004, time: 50, -932109170.0539378
Epochs: 114, Loss: 2155769856.0, lr: 0.004, time: 50, -924759247.8632482
Epochs: 115, Loss: 2139846144.0, lr: 0.004, time: 50, -917525184.3386246
Epochs: 116, Loss: 2124382720.0, lr: 0.004, time: 50, -910411324.109015
Epochs: 117, Loss: 2122033792.0, lr: 0.004, time: 50, -903409740.560748
Epochs: 118, Loss: 2106164096.0, lr: 0.004, time: 50, -896385060.0823048
Epochs: 119, Loss: 2090362624.0, lr: 0.004, time: 50, -889485658.5524976
Epochs: 120, Loss: 2075204992.0, lr: 0.004, time: 50, -882699026.1010103
Epochs: 121, Loss: 2060199424.0, lr: 0.004, time: 50, -876020264.7447449
Epochs: 122, Loss: 2045248896.0, lr: 0.004, time: 50, -869454431.7460319
Epochs: 123, Loss: 2031127808.0, lr: 0.004, time: 50, -862998589.4198625
Epochs: 124, Loss: 2016727936.0, lr: 0.004, time: 50, -856643261.1306044
Epochs: 125, Loss: 2002724864.0, lr: 0.004, time: 50, -850383737.1980677
Epochs: 126, Loss: 1988791296.0, lr: 0.004, time: 50, -844218148.0459771
########## Saving Trace ##########
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 217, in <module>
    traj, dtraj_dt = odeint(dyn_system, x_init, time, method='euler', options=dict(step_size=dt))
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 209, in odeint_adjoint
    adjoint_method, adjoint_options, t.requires_grad, *adjoint_params)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/adjoint.py", line 23, in forward
    ans, ans_dt = odeint(func, y0, t, rtol=rtol, atol=atol, method=method, options=options)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/odeint.py", line 57, in odeint
    solution, solution_dt = solver.integrate(t)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/solvers.py", line 72, in integrate
    dy, f0 = self._step_func(self.func, t0, dt, t1, y0)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/fixed_grid.py", line 9, in _step_func
    f0 = func(t0, y0, perturb=Perturb.NEXT if self.perturb else Perturb.NONE)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torchdiffeq_ctrl/_impl/misc.py", line 193, in forward
    return self.base_func(t, y)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1208, in _call_impl
    result = forward_call(*input, **kwargs)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 165, in forward
    u = self._ctrl(t, x)
  File "/home/daniel/Repos/Mujoco_Python_Sandbox/value_gradient/neural_value_synthesis_diffeq.py", line 110, in hjb
    x_enc = self._encoder(x)
  File "tv_value_synthesis_trajopt_cartpole.py", line 44, in state_encoder
    qp = atan2_encoder(qp)
  File "tv_value_synthesis_trajopt_cartpole.py", line 37, in atan2_encoder
    return torch.atan2(torch.sin(x), torch.cos(x))
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "tv_value_synthesis_trajopt_cartpole.py", line 261, in <module>
    model_scripted = torch.jit.script(dyn_system.value_func.to('cpu'))  # Export to TorchScript
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_script.py", line 1287, in script
    obj, torch.jit._recursive.infer_methods_to_compile
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 476, in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 542, in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
  File "/home/daniel/.local/share/virtualenvs/Mujoco_Python_Sandbox-gNKKWzd6/lib/python3.7/site-packages/torch/jit/_recursive.py", line 393, in create_methods_and_properties_from_stubs
    concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
RuntimeError:
attribute lookup is not defined on python value of type 'SimulationParams':
  File "tv_value_synthesis_trajopt_cartpole.py", line 74
    def forward(self, t, x):
        time = torch.ones((sim_params.nsim, 1, 1)).to(device) * t
                           ~~~~~~~~~~~~~~~ <--- HERE
        aug_x = torch.cat((x, time), dim=2)
        return self.nn(aug_x)